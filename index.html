<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html" xmlns="http://www.w3.org/1999/html">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
    <title>Knowledge Base</title>
    <link rel="stylesheet" type="text/css" href="css/homepage.css">
</head>


<body>
<script type="text/javascript" src="js/src/jquery-1.8.2.min.js"></script>
<script type="text/javascript" src="js/src/g6.min.js"></script>
<script type="text/javascript" src="js/src/axios.min.js"></script>
<script type="text/javascript" src="js/src/jquery.autocomplete.js"></script>
<script type="text/javascript" src="js/formattrans.js"></script>
<script type="text/javascript" src="js/homepage.js"></script>

<!-- /* 图的画布容器 */ -->
<div id="banner">
    <h1>东周列国知识图谱</h1>
    <div class="link">
        <button class="banner_btn selected" id="side_change">Sidebar</button>
    </div>
</div>
<div>

    <div id='slider' class="sidebar">
        <!-- <div id='entity'>
            <h4>主要实体类型查询</h4>
        </div> -->
        <div id='entity'>
            <h3>Node Labels</h3>
        </div>
        <div id="entity_rela">
            <h3>Relationships of Nodes </h3>
        </div>
        <div id='relation'>
            <h3>Relationship Types</h3>
        </div>
        <div id="property">
            <h3>Show Properties</h3>
            <div id="proul">
            </div>
        </div>
    </div>
    <div class="main">
        <div id="input_div">
            <input type="text" placeholder="Please enter key words..." name="country" id="autocomplete" />
        </div>
        <div id="mountNode"></div>
    </div>


</div>


<script>
    G6.registerBehavior('node-activate', {
        getDefaultCfg() {
            return {
                multiple: true
            };
        },
        getEvents() {
            return {
                'node:mouseenter': 'onMouseenter',
                'node:dblclick': 'onDblclick'
            };
        },
        // onMouseenter(e) {
        //
        //     $('#proul').children().remove();
        //     var pros = $.extend({}, e.item.getModel().properties);
        //
        //     for (var p in pros) {
        //         $('#proul').append(
        //             '<ul class="pro_slider"><li><b>' + p + ' : </b> ' + pros[p] + '</li>')
        //     }
        // },
        //
        // onDblclick(e) {
        //     readNeo4j(e.item.getModel(), 2)
        //     // console.log(e.item.getModel());
        // }
    });


    const graph = new G6.Graph({
        container: 'mountNode',
        width: window.screen.availWidth,
        height: document.body.clientHeight,
        modes: {
            default: ['drag-node', 'node-activate'],
        },
        layout: {
            type: 'force',
            center: [window.screen.availWidth * 0.45, document.body.clientHeight * 0.4],
            preventOverlap: true,
            linkDistance: 180,
        },

        defaultNode: {
            size: 28,
            color: '#5B8FF9',
            style: {
                lineWidth: 2,
                fill: '',
                stroke: '',
            },
            label: 'node-label',
            labelCfg: {
                position: 'top',
                style: {
                    fill: '#ddd',
                },
            }

        },
        defaultEdge: {
            size: 1,
            color: '#aaa',
            label: 'node-label',
            labelCfg: {
                style: {
                    fill: '#ddd',
                    stroke: '',
                },
            },
        }
    });


    function changeStyle(data) {
        const nodes = data.nodes;

        nodes.forEach((node) => {

            if (!node.style) {
                node.style = {};
            }
            node.style = {
                fill: color_set[node.id % color_set.length],
                stroke: '',
            };

            switch (
                node.properties.type // Configure the graph based on the 'type' of nodes
                ) {
                case ('Person'):
                {
                    node.size = 32;
                    break;
                }
            }
        });
    }

    function refreshDragedNodePosition(e) {
        const model = e.item.get('model');
        model.fx = e.x;
        model.fy = e.y;
    }
    graph.on('node:dragstart', (e) => {
        graph.layout();
        refreshDragedNodePosition(e);
    });
    graph.on('node:drag', (e) => {
        refreshDragedNodePosition(e);
    });
</script>
</body>
</html>